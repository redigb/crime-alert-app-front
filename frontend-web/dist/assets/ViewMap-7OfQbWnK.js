import{r as t,j as e,S as D,c as z,B as j,F,o as G,G as K,b as X,I as J,z as q,C as H,f as E,H as $,A as L,U as P,J as O,d as Q,X as Y,R as B}from"./index-DcV7uD1U.js";import{M as Z,a as ee,l as se}from"./maplibre-gl-BKec0oX6.js";import{c as U}from"./useCn-C0Y9tLwQ.js";import{M as te,u as W,P as ie,a as ae,b as ne,L as le,m as v,H as re}from"./HeaderTitle-D09V2w3Z.js";class ce extends t.Component{getSnapshotBeforeUpdate(n){const i=this.props.childRef.current;if(i&&n.isPresent&&!this.props.isPresent){const c=i.offsetParent,u=c instanceof HTMLElement&&c.offsetWidth||0,l=this.props.sizeRef.current;l.height=i.offsetHeight||0,l.width=i.offsetWidth||0,l.top=i.offsetTop,l.left=i.offsetLeft,l.right=u-l.width-l.left}return null}componentDidUpdate(){}render(){return this.props.children}}function de({children:a,isPresent:n,anchorX:i}){const c=t.useId(),u=t.useRef(null),l=t.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:h}=t.useContext(te);return t.useInsertionEffect(()=>{const{width:g,height:r,top:N,left:d,right:f}=l.current;if(n||!u.current||!g||!r)return;const p=i==="left"?`left: ${d}`:`right: ${f}`;u.current.dataset.motionPopId=c;const o=document.createElement("style");return h&&(o.nonce=h),document.head.appendChild(o),o.sheet&&o.sheet.insertRule(`
          [data-motion-pop-id="${c}"] {
            position: absolute !important;
            width: ${g}px !important;
            height: ${r}px !important;
            ${p}px !important;
            top: ${N}px !important;
          }
        `),()=>{document.head.contains(o)&&document.head.removeChild(o)}},[n]),e.jsx(ce,{isPresent:n,childRef:u,sizeRef:l,children:t.cloneElement(a,{ref:u})})}const oe=({children:a,initial:n,isPresent:i,onExitComplete:c,custom:u,presenceAffectsLayout:l,mode:h,anchorX:g})=>{const r=W(he),N=t.useId();let d=!0,f=t.useMemo(()=>(d=!1,{id:N,initial:n,isPresent:i,custom:u,onExitComplete:p=>{r.set(p,!0);for(const o of r.values())if(!o)return;c&&c()},register:p=>(r.set(p,!1),()=>r.delete(p))}),[i,r,c]);return l&&d&&(f={...f}),t.useMemo(()=>{r.forEach((p,o)=>r.set(o,!1))},[i]),t.useEffect(()=>{!i&&!r.size&&c&&c()},[i]),h==="popLayout"&&(a=e.jsx(de,{isPresent:i,anchorX:g,children:a})),e.jsx(ie.Provider,{value:f,children:a})};function he(){return new Map}const S=a=>a.key||"";function T(a){const n=[];return t.Children.forEach(a,i=>{t.isValidElement(i)&&n.push(i)}),n}const V=({children:a,custom:n,initial:i=!0,onExitComplete:c,presenceAffectsLayout:u=!0,mode:l="sync",propagate:h=!1,anchorX:g="left"})=>{const[r,N]=ae(h),d=t.useMemo(()=>T(a),[a]),f=h&&!r?[]:d.map(S),p=t.useRef(!0),o=t.useRef(d),b=W(()=>new Map),[y,s]=t.useState(d),[x,M]=t.useState(d);ne(()=>{p.current=!1,o.current=d;for(let w=0;w<x.length;w++){const m=S(x[w]);f.includes(m)?b.delete(m):b.get(m)!==!0&&b.set(m,!1)}},[x,f.length,f.join("-")]);const C=[];if(d!==y){let w=[...d];for(let m=0;m<x.length;m++){const R=x[m],I=S(R);f.includes(I)||(w.splice(m,0,R),C.push(R))}return l==="wait"&&C.length&&(w=C),M(T(w)),s(d),null}const{forceRender:k}=t.useContext(le);return e.jsx(e.Fragment,{children:x.map(w=>{const m=S(w),R=h&&!r?!1:d===x||f.includes(m),I=()=>{if(b.has(m))b.set(m,!0);else return;let A=!0;b.forEach(_=>{_||(A=!1)}),A&&(k==null||k(),M(o.current),h&&(N==null||N()),c&&c())};return e.jsx(oe,{isPresent:R,initial:!p.current||i?void 0:!1,custom:n,presenceAffectsLayout:u,mode:l,onExitComplete:R?void 0:I,anchorX:g,children:w},m)})})};function xe(){const[a,n]=t.useState(!1);return t.useEffect(()=>{if(typeof window<"u"){const i=()=>{n(window.innerWidth<768)};return i(),window.addEventListener("resize",i),()=>window.removeEventListener("resize",i)}},[]),a}const be=()=>{const[a,n]=t.useState("todos"),[i,c]=t.useState(!1),[u,l]=t.useState(!1),h=xe(),g=s=>{console.log(`Alerta seleccionada: ${s}`)},[r,N]=t.useState([]),[d,f]=t.useState(!0),[p,o]=t.useState(null);if(t.useEffect(()=>{(async()=>{const x=await se();N(x),f(!1)})()},[]),d)return e.jsx(D,{});const b=s=>{switch(s==null?void 0:s.toLowerCase()){case"robo":return e.jsx(E,{className:"h-5 w-5 text-white"});case"incendio":return e.jsx($,{className:"h-5 w-5 text-white"});case"accidente":return e.jsx(L,{className:"h-5 w-5 text-white"});case"sospechoso":return e.jsx(P,{className:"h-5 w-5 text-white"});case"servicios":return e.jsx(B,{className:"h-5 w-5 text-white"});default:return e.jsx(B,{className:"h-5 w-5 text-white"})}},y=s=>{switch(s==null?void 0:s.toLowerCase()){case"robo":return"bg-red-500";case"incendio":return"bg-orange-500";case"accidente":return"bg-yellow-500";case"sospechoso":return"bg-purple-500";case"servicios":return"bg-blue-500";default:return"bg-green-500"}};return console.log("data: ",r),e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsxs(v.div,{className:"p-4 border-b border-[#2e3347]/50 flex items-center justify-between",initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.5},children:[e.jsx(re,{icon:e.jsx(z,{className:"h-7 w-7"}),title1:"Mapa de",title2:"Incidentes",subtitle:"Visualiza en tiempo real los reportes de tu comunidad."}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(j,{variant:"outline",className:"bg-[#1a1d29]/80 border border-[#2e3347] text-white hover:bg-[#2e3347]/50 flex items-center gap-2",onClick:()=>c(!i),children:[e.jsx(F,{className:"h-4 w-4"}),e.jsx("span",{className:`${h?"hidden":"inline"}`,children:"Filtrar Reportes"})]}),h&&e.jsx(G,{onClick:()=>l(!0),variant:"outline",className:"h-8 w-8 md:h-9 md:w-9 bg-[#1a1d29]/80 border border-[#2e3347] text-white hover:bg-[#2e3347]/50",children:e.jsx(K,{className:"h-4 w-4"})})]})]}),e.jsx(V,{children:i&&e.jsx(v.div,{className:"border-b border-[#2e3347]/50 bg-[#13151f]/90 backdrop-blur-sm rounded-t-xl border-rounded-t-xl",initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.3},children:e.jsxs("div",{className:"p-4 flex flex-wrap gap-3",children:[e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs("div",{className:"relative w-64",children:[e.jsx(X,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(J,{placeholder:"Buscar reportes...",className:"pl-10 bg-[#1a1d29]/80 border-[#2e3347] text-white h-10 rounded-lg"})]})}),e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[e.jsx(j,{size:"sm",className:`${a==="todos"?"bg-[#6c5ce7] hover:bg-[#5b4bc9] text-white":"bg-[#1a1d29]/80 border border-[#2e3347] text-white hover:bg-[#2e3347]/50"} rounded-md transition`,onClick:()=>n("todos"),children:"Todos"}),e.jsx(j,{size:"sm",className:`${a==="robos"?"bg-red-500 hover:bg-red-600 text-white border-red-500":"bg-[#1a1d29]/80 border border-[#2e3347] text-white hover:bg-[#2e3347]/50"}  rounded-md transition`,onClick:()=>n("robos"),children:"Robos"}),e.jsx(j,{size:"sm",className:`${a==="incendios"?"bg-orange-500 hover:bg-orange-600 text-white border-orange-500":"bg-[#1a1d29]/80 border border-[#2e3347] text-white hover:bg-[#2e3347]/50"} rounded-md transition`,onClick:()=>n("incendios"),children:"Incendios"}),e.jsx(j,{size:"sm",className:`${a==="accidentes"?"bg-yellow-500 hover:bg-yellow-600 border-yellow-500":"bg-[#1a1d29]/80 border border-[#2e3347] text-white hover:bg-[#2e3347]/50"} border-transparent rounded-md transition`,onClick:()=>n("accidentes"),children:"Accidentes"}),e.jsx(j,{size:"sm",className:a==="sospechosos"?"bg-purple-500 hover:bg-purple-600":"bg-[#1a1d29]/80 border border-[#2e3347] text-white hover:bg-[#2e3347]/50",onClick:()=>n("sospechosos"),children:"Sospechosos"})]}),e.jsxs("div",{className:"flex gap-2 ml-auto",children:[e.jsxs(j,{variant:"outline",size:"sm",className:"border-[#2e3347] text-white hover:bg-[#2e3347]/50",children:[e.jsx(q,{className:"h-4 w-4 mr-2"}),"Últimas 24h"]}),e.jsxs(j,{variant:"outline",size:"sm",className:"border-[#2e3347] text-white hover:bg-[#2e3347]/50",children:[e.jsx(F,{className:"h-4 w-4 mr-2"}),"Más filtros"]})]})]})})}),e.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx("div",{className:"w-full h-full bg-[#1f1f22] relative",children:e.jsx(Z,{initialViewState:{longitude:-76.2422,latitude:-9.9306,zoom:14},style:{width:"100%",height:"100%"},mapStyle:"https://basemaps.cartocdn.com/gl/dark-matter-gl-style/style.json",children:r.map(s=>{var k;const x=parseFloat(s.longitude),M=parseFloat(s.latitude);if(isNaN(x)||isNaN(M))return null;const C=p===s.id;return e.jsx(ee,{longitude:x,latitude:M,children:e.jsxs("div",{className:"relative z-10",onMouseEnter:()=>o(s.id),onMouseLeave:()=>o(null),children:[e.jsxs(v.div,{className:`w-10 h-10 rounded-full flex items-center justify-center shadow-md cursor-pointer relative ${y(s.titulo)}`,animate:{scale:C?1.2:1},transition:{duration:.3},children:[b(s.titulo),C&&e.jsx(v.div,{className:`absolute inset-0 rounded-full ${y(s.titulo)} opacity-30`,initial:{scale:1},animate:{scale:2,opacity:0},transition:{duration:1.5,repeat:1/0,repeatType:"loop"}})]}),C&&e.jsxs("div",{className:"absolute z-20 bg-[#1a1d29]/95 border border-[#2e3347] p-3 rounded-lg w-64 shadow-xl top-full mt-2",children:[e.jsxs("div",{className:"flex items-start gap-2 mb-2",children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center ${y(s.titulo)}`,children:b(s.titulo)}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-sm",children:s.titulo}),e.jsx("p",{className:"text-xs text-gray-400",children:s.direccion})]})]}),e.jsx("p",{className:"text-xs text-gray-300 line-clamp-2 mb-2",children:s.descripcion}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(H,{className:"bg-yellow-500",children:s.estado||"pendiente"}),e.jsx("span",{className:"text-xs text-gray-400",children:(k=s.fecha_hora_report)==null?void 0:k.split(" ")[1]})]})]})]})},s.id)})})}),e.jsxs("div",{className:"absolute bottom-4 left-4 bg-[#1a1d29]/90 backdrop-blur-sm rounded-lg border border-[#2e3347] p-2 md:p-3 max-w-[140px] md:max-w-none",children:[e.jsx("h3",{className:"text-xs md:text-sm font-medium mb-1 md:mb-2",children:"Leyenda"}),e.jsxs("div",{className:"space-y-1 md:space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-1 md:gap-2",children:[e.jsx("div",{className:"w-3 h-3 md:w-4 md:h-4 rounded-full bg-red-500 flex items-center justify-center",children:e.jsx(E,{className:"h-2 w-2 md:h-2.5 md:w-2.5 text-white"})}),e.jsx("span",{className:"text-[10px] md:text-xs",children:"Robos"})]}),e.jsxs("div",{className:"flex items-center gap-1 md:gap-2",children:[e.jsx("div",{className:"w-3 h-3 md:w-4 md:h-4 rounded-full bg-orange-500 flex items-center justify-center",children:e.jsx($,{className:"h-2 w-2 md:h-2.5 md:w-2.5 text-white"})}),e.jsx("span",{className:"text-[10px] md:text-xs",children:"Incendios"})]}),e.jsxs("div",{className:"flex items-center gap-1 md:gap-2",children:[e.jsx("div",{className:"w-3 h-3 md:w-4 md:h-4 rounded-full bg-yellow-500 flex items-center justify-center",children:e.jsx(L,{className:"h-2 w-2 md:h-2.5 md:w-2.5 text-white"})}),e.jsx("span",{className:"text-[10px] md:text-xs",children:"Accidentes"})]}),e.jsxs("div",{className:"flex items-center gap-1 md:gap-2",children:[e.jsx("div",{className:"w-3 h-3 md:w-4 md:h-4 rounded-full bg-purple-500 flex items-center justify-center",children:e.jsx(P,{className:"h-2 w-2 md:h-2.5 md:w-2.5 text-white"})}),e.jsx("span",{className:"text-[10px] md:text-xs",children:"Sospechosos"})]})]})]}),e.jsxs("div",{className:"absolute bottom-4 left-4 bg-[#1a1d29]/90 backdrop-blur-sm rounded-lg border border-[#2e3347] p-3",children:[e.jsx("h3",{className:"text-sm font-medium mb-2",children:"Leyenda"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 rounded-full bg-red-500 flex items-center justify-center",children:e.jsx(E,{className:"h-2.5 w-2.5 text-white"})}),e.jsx("span",{className:"text-xs",children:"Robos"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 rounded-full bg-orange-500 flex items-center justify-center",children:e.jsx($,{className:"h-2.5 w-2.5 text-white"})}),e.jsx("span",{className:"text-xs",children:"Incendios"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 rounded-full bg-yellow-500 flex items-center justify-center",children:e.jsx(L,{className:"h-2.5 w-2.5 text-white"})}),e.jsx("span",{className:"text-xs",children:"Accidentes"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 rounded-full bg-purple-500 flex items-center justify-center",children:e.jsx(P,{className:"h-2.5 w-2.5 text-white"})}),e.jsx("span",{className:"text-xs",children:"Sospechosos"})]})]})]}),h&&!u&&e.jsx(j,{onClick:()=>l(!0),className:"absolute bottom-4 right-4 bg-[#6c5ce7] hover:bg-[#5b4bc9] text-white rounded-full h-12 w-12 shadow-lg",children:e.jsx(O,{className:"h-5 w-5"})})]}),!h&&e.jsx("div",{className:"w-80 bg-[#13151f] border-l border-[#2e3347]/50 overflow-y-auto hidden md:block",children:e.jsxs("div",{className:"p-4",children:[e.jsx("h2",{className:"text-xl font-bold mb-4",children:"Reportes Recientes"}),e.jsx("div",{className:"space-y-3",children:r.map(s=>e.jsx(v.div,{className:"bg-[#1a1d29]/80 rounded-lg p-3 cursor-pointer hover:bg-[#1a1d29] transition-colors",initial:{opacity:0,x:20},animate:{opacity:1,x:0},whileHover:{scale:1.02},onClick:()=>g(s.id),children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:U("w-10 h-10 rounded-full flex items-center justify-center",y(s.categoria)),children:b(s.categoria)}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-medium",children:s.titulo}),e.jsxs("p",{className:"text-sm text-gray-400",children:[s.ubicacion," • hace 10 min"]}),e.jsx("div",{className:"flex justify-end mt-1",children:e.jsxs(j,{className:"h-6 p-0 text-[#6c5ce7] text-xs flex items-center",onClick:x=>{x.stopPropagation(),g(s.id)},children:["Ver detalles ",e.jsx(Q,{className:"h-3 w-3 ml-1"})]})})]})]})},s.id))})]})}),e.jsx(V,{children:h&&u&&e.jsx(v.div,{className:"absolute inset-0 z-20 bg-black/50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>l(!1),children:e.jsxs(v.div,{className:"absolute top-0 right-0 bottom-0 w-[85%] max-w-[320px] bg-[#13151f] overflow-y-auto",initial:{x:"100%"},animate:{x:0},exit:{x:"100%"},transition:{type:"spring",damping:25,stiffness:300},onClick:s=>s.stopPropagation(),children:[e.jsxs("div",{className:"p-4 border-b border-[#2e3347]/50 flex items-center justify-between",children:[e.jsx("h2",{className:"text-lg font-bold",children:"Reportes Recientes"}),e.jsx(j,{variant:"ghost",className:"h-8 w-8",onClick:()=>l(!1),children:e.jsx(Y,{className:"h-4 w-4"})})]}),e.jsx("div",{className:"p-3",children:e.jsx("div",{className:"space-y-3",children:r.map(s=>e.jsx(v.div,{className:"bg-[#1a1d29]/80 rounded-lg p-3 cursor-pointer hover:bg-[#1a1d29] transition-colors",initial:{opacity:0,x:20},animate:{opacity:1,x:0},onClick:()=>g(s.id),children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("div",{className:U("w-8 h-8 rounded-full flex items-center justify-center",y(s.categoria)),children:b(s.categoria)}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-medium text-sm",children:s.titulo}),e.jsx("p",{className:"text-xs text-gray-400 truncate",children:s.ubicacion}),e.jsxs("div",{className:"flex items-center justify-between mt-1",children:[e.jsx(H,{className:`text-[10px] px-1.5 py-0 h-4 ${s.estado==="verificada"?"bg-green-500":s.estado==="urgente"?"bg-red-500":"bg-yellow-500"}`,children:s.estado}),e.jsx("span",{className:"text-[10px] text-gray-400",children:s.fecha})]})]})]})},s.id))})}),e.jsxs("div",{className:"p-3 border-t border-[#2e3347]/50",children:[e.jsx("h3",{className:"font-medium text-sm mb-2",children:"Ubicaciones recientes"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"bg-[#1a1d29]/80 rounded-lg p-2 flex items-center gap-2",children:[e.jsx(z,{className:"h-4 w-4 text-[#6c5ce7]"}),e.jsx("span",{className:"text-xs",children:"Centro Comercial"})]}),e.jsxs("div",{className:"bg-[#1a1d29]/80 rounded-lg p-2 flex items-center gap-2",children:[e.jsx(z,{className:"h-4 w-4 text-[#6c5ce7]"}),e.jsx("span",{className:"text-xs",children:"Urb. Las Palmeras"})]})]})]})]})})})]})]})};export{be as default};
